{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sonwonjae\\\\react\\\\react-tutorial\\\\canvas-example\\\\src\\\\three\\\\ThreeTuto2.js\";\nimport React, { Component } from 'react';\nimport * as THREE from 'three';\nimport OrbitControls from 'three-orbitcontrols';\nimport * as dat from 'dat.gui';\nimport gsap from 'gsap';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport class ThreeTuto2 extends Component {\n  constructor(...args) {\n    super(...args);\n\n    this.animate = () => {\n      this.renderer.render(this.scene, this.camera);\n      requestAnimationFrame(this.animate); // 배경 움직임\n\n      this.frame += 0.01;\n      const {\n        array,\n        originalPosition,\n        randomValue\n      } = this.planeMesh.geometry.attributes.position;\n\n      for (let i = 0; i < array.length; i += 3) {\n        // x\n        array[i] = originalPosition[i] + Math.cos(this.frame + randomValue[i]) * 0.01;\n        this.planeMesh.geometry.attributes.position.needsUpdate = true; // y\n\n        array[i + 1] = originalPosition[i + 1] + Math.sin(this.frame + randomValue[i + 1]) * 0.01;\n        this.planeMesh.geometry.attributes.position.needsUpdate = true;\n      }\n\n      this.raycaster.setFromCamera(this.mouse, this.camera);\n      const intersects = this.raycaster.intersectObject(this.planeMesh);\n\n      if (intersects.length > 0) {\n        const {\n          color\n        } = intersects[0].object.geometry.attributes; // vertice 1\n\n        color.setX(intersects[0].face.a, 0.3);\n        color.setY(intersects[0].face.a, 0.6);\n        color.setZ(intersects[0].face.a, 1); // vertice 2\n\n        color.setX(intersects[0].face.b, 0.3);\n        color.setY(intersects[0].face.b, 0.6);\n        color.setZ(intersects[0].face.b, 1); // vertice 3\n\n        color.setX(intersects[0].face.c, 0.3);\n        color.setY(intersects[0].face.c, 0.6);\n        color.setZ(intersects[0].face.c, 1);\n        color.needsUpdate = true;\n        const initialColor = {\n          r: 0.05,\n          g: 0.1,\n          b: 0.2\n        };\n        const hoverColor = {\n          r: 0.3,\n          g: 0.6,\n          b: 1\n        };\n        gsap.to(hoverColor, {\n          r: initialColor.r,\n          g: initialColor.g,\n          b: initialColor.b,\n          duration: 1,\n          onUpdate: () => {\n            // vertice 1\n            color.setX(intersects[0].face.a, hoverColor.r);\n            color.setY(intersects[0].face.a, hoverColor.g);\n            color.setZ(intersects[0].face.a, hoverColor.b); // vertice 2\n\n            color.setX(intersects[0].face.b, hoverColor.r);\n            color.setY(intersects[0].face.b, hoverColor.g);\n            color.setZ(intersects[0].face.b, hoverColor.b); // vertice 3\n\n            color.setX(intersects[0].face.c, hoverColor.r);\n            color.setY(intersects[0].face.c, hoverColor.g);\n            color.setZ(intersects[0].face.c, hoverColor.b);\n          }\n        });\n      }\n    };\n  }\n\n  componentDidMount() {\n    const width = window.innerWidth;\n    const height = window.innerHeight;\n    this.width = width;\n    this.height = height; // resize 이벤트\n\n    window.addEventListener('resize', function (e) {\n      this.width = window.innerWidth;\n      this.height = window.innerWidth;\n    }); //raycaster 추가\n\n    const raycaster = new THREE.Raycaster(); // 카메라로 찍으려는 3D무대\n\n    const scene = new THREE.Scene(); // 카메라\n\n    const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000); // 플레이어 or 영사기\n\n    const renderer = new THREE.WebGLRenderer();\n    renderer.setSize(width, height); // 픽셀단위로 진하게 해줌\n\n    renderer.setPixelRatio(devicePixelRatio); // HTML canvas\n\n    this.element.appendChild(renderer.domElement); //GUI\n\n    const gui = new dat.GUI();\n    const world = {\n      plane: {\n        width: 800,\n        height: 800,\n        widthSegments: 100,\n        heightSegments: 100\n      }\n    }; // x값 조정하는 GUI\n\n    gui.add(world.plane, 'width', 100, 600).onChange(generatePlane); // y값 조정하는 GUI\n\n    gui.add(world.plane, 'height', 100, 600).onChange(generatePlane); // x seg값 조정하는 GUI\n\n    gui.add(world.plane, 'widthSegments', 10, 200).onChange(generatePlane); // y seg값 조정하는 GUI\n\n    gui.add(world.plane, 'heightSegments', 10, 200).onChange(generatePlane);\n    const randomValue = [];\n\n    function generatePlane() {\n      planeMesh.geometry.dispose();\n      planeMesh.geometry = new THREE.PlaneGeometry(world.plane.width, world.plane.height, world.plane.widthSegments, world.plane.heightSegments); // x,y,z 값 조정법\n\n      const {\n        array\n      } = planeMesh.geometry.attributes.position;\n\n      for (let i = 0; i < array.length; i++) {\n        if (i % 3 === 0) {\n          const x = array[i];\n          const y = array[i + 1];\n          const z = array[i + 2];\n          array[i] = x + (Math.random() - 0.5) * 3;\n          array[i + 2] = y + (Math.random() - 0.5) * 3;\n          array[i + 2] = z + (Math.random() - 0.5) * 3;\n        }\n\n        randomValue.push(Math.random() * Math.PI * 3);\n      } // randomValue 정의\n\n\n      planeMesh.geometry.attributes.position.randomValue = randomValue; // OriginalPosition 정의\n\n      planeMesh.geometry.attributes.position.originalPosition = planeMesh.geometry.attributes.position.array;\n      const colors = [];\n\n      for (let i = 0; i < planeMesh.geometry.attributes.position.count; i++) {\n        // r,g,b\n        colors.push(0.05, 0.1, 0.2);\n      }\n\n      planeMesh.geometry.setAttribute('color', new THREE.BufferAttribute(new Float32Array(colors), 3));\n    } // PlaneGeometry\n\n\n    const planeGeometry = new THREE.PlaneGeometry(world.plane.width, world.plane.height, world.plane.widthSegments, world.plane.heightSegments);\n    const planeMeterial = new THREE.MeshPhongMaterial({\n      side: THREE.DoubleSide,\n      flatShading: THREE.FlatShading,\n      vertexColors: true\n    });\n    const planeMesh = new THREE.Mesh(planeGeometry, planeMeterial);\n    scene.add(planeMesh);\n    generatePlane(); // 빛\n\n    const light = new THREE.DirectionalLight(0xffffff, 1);\n    light.position.set(1, -1, 1);\n    scene.add(light); // 뒤쪽 빛\n\n    const backLight = new THREE.DirectionalLight(0xffffff, 1);\n    backLight.position.set(0, 0, -1);\n    scene.add(backLight); // OrbitControls\n\n    new OrbitControls(camera, renderer.domElement); // 카메라 뷰 깊이\n\n    camera.position.z = 50;\n    camera.rotateX(-50);\n    camera.rotateY(-50);\n    console.log(camera);\n    const mouse = {\n      x: undefined,\n      y: undefined\n    };\n    window.addEventListener('mousemove', e => {\n      mouse.x = e.clientX / window.innerWidth * 2 - 1;\n      mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;\n    }); // frame\n\n    const frame = 0;\n    this.scene = scene;\n    this.camera = camera;\n    this.renderer = renderer;\n    this.planeMesh = planeMesh;\n    this.mouse = mouse;\n    this.raycaster = raycaster;\n    this.frame = frame;\n    this.randomValue = randomValue;\n    this.animate(); // 클릭 옵션\n\n    document.querySelector('#link').addEventListener('click', e => {\n      e.preventDefault();\n      gsap.to('#container', {\n        opacity: 0\n      });\n      gsap.to(camera.position, {\n        x: 75,\n        y: -75,\n        z: 1,\n        duration: 1.2\n      });\n      gsap.to(camera.rotation, {\n        x: 1,\n        y: 1,\n        duration: 8\n      });\n      gsap.to(light, {\n        intensity: 0,\n        delay: 0.3,\n        duration: 1.2\n      });\n    });\n  } // 첫 줄은 카메라 뷰로 렌더링하겠다\n  // 다음 두 줄은 3D박스를 x,y축으로 0.01씩 이동하겠다\n  // 마지막 requestAnimationFrame 함수는 this.animate함수를 계속 호출하라는 뜻\n  // 최대 1ms (1초에 60번씩 그려라) => 성능이 낮은 PC나 CPU/GPU 점유율에 따라 동적으로 변하기도 함\n\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: el => this.element = el\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 12\n    }, this);\n  }\n\n}\nexport default ThreeTuto2;","map":{"version":3,"sources":["C:/Users/sonwonjae/react/react-tutorial/canvas-example/src/three/ThreeTuto2.js"],"names":["React","Component","THREE","OrbitControls","dat","gsap","ThreeTuto2","animate","renderer","render","scene","camera","requestAnimationFrame","frame","array","originalPosition","randomValue","planeMesh","geometry","attributes","position","i","length","Math","cos","needsUpdate","sin","raycaster","setFromCamera","mouse","intersects","intersectObject","color","object","setX","face","a","setY","setZ","b","c","initialColor","r","g","hoverColor","to","duration","onUpdate","componentDidMount","width","window","innerWidth","height","innerHeight","addEventListener","e","Raycaster","Scene","PerspectiveCamera","WebGLRenderer","setSize","setPixelRatio","devicePixelRatio","element","appendChild","domElement","gui","GUI","world","plane","widthSegments","heightSegments","add","onChange","generatePlane","dispose","PlaneGeometry","x","y","z","random","push","PI","colors","count","setAttribute","BufferAttribute","Float32Array","planeGeometry","planeMeterial","MeshPhongMaterial","side","DoubleSide","flatShading","FlatShading","vertexColors","Mesh","light","DirectionalLight","set","backLight","rotateX","rotateY","console","log","undefined","clientX","clientY","document","querySelector","preventDefault","opacity","rotation","intensity","delay","el"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport * as THREE from 'three';\r\nimport OrbitControls from 'three-orbitcontrols';\r\n\r\nimport * as dat from 'dat.gui';\r\nimport gsap from 'gsap';\r\n\r\nexport class ThreeTuto2 extends Component {\r\n  componentDidMount() {\r\n    const width = window.innerWidth;\r\n    const height = window.innerHeight;\r\n    this.width = width;\r\n    this.height = height;\r\n\r\n    // resize 이벤트\r\n    window.addEventListener('resize', function (e) {\r\n      this.width = window.innerWidth;\r\n      this.height = window.innerWidth;\r\n    });\r\n\r\n    //raycaster 추가\r\n    const raycaster = new THREE.Raycaster();\r\n\r\n    // 카메라로 찍으려는 3D무대\r\n    const scene = new THREE.Scene();\r\n\r\n    // 카메라\r\n    const camera = new THREE.PerspectiveCamera(\r\n      75,\r\n      window.innerWidth / window.innerHeight,\r\n      0.1,\r\n      1000\r\n    );\r\n\r\n    // 플레이어 or 영사기\r\n    const renderer = new THREE.WebGLRenderer();\r\n    renderer.setSize(width, height);\r\n\r\n    // 픽셀단위로 진하게 해줌\r\n    renderer.setPixelRatio(devicePixelRatio);\r\n\r\n    // HTML canvas\r\n    this.element.appendChild(renderer.domElement);\r\n    //GUI\r\n    const gui = new dat.GUI();\r\n    const world = {\r\n      plane: {\r\n        width: 800,\r\n        height: 800,\r\n        widthSegments: 100,\r\n        heightSegments: 100\r\n      }\r\n    };\r\n\r\n    // x값 조정하는 GUI\r\n    gui.add(world.plane, 'width', 100, 600).onChange(generatePlane);\r\n\r\n    // y값 조정하는 GUI\r\n    gui.add(world.plane, 'height', 100, 600).onChange(generatePlane);\r\n\r\n    // x seg값 조정하는 GUI\r\n    gui.add(world.plane, 'widthSegments', 10, 200).onChange(generatePlane);\r\n\r\n    // y seg값 조정하는 GUI\r\n    gui.add(world.plane, 'heightSegments', 10, 200).onChange(generatePlane);\r\n    const randomValue = [];\r\n\r\n    function generatePlane() {\r\n      planeMesh.geometry.dispose();\r\n      planeMesh.geometry = new THREE.PlaneGeometry(\r\n        world.plane.width,\r\n        world.plane.height,\r\n        world.plane.widthSegments,\r\n        world.plane.heightSegments\r\n      );\r\n\r\n      // x,y,z 값 조정법\r\n      const { array } = planeMesh.geometry.attributes.position;\r\n      for (let i = 0; i < array.length; i++) {\r\n        if (i % 3 === 0) {\r\n          const x = array[i];\r\n          const y = array[i + 1];\r\n          const z = array[i + 2];\r\n\r\n          array[i] = x + (Math.random() - 0.5) * 3;\r\n          array[i + 2] = y + (Math.random() - 0.5) * 3;\r\n          array[i + 2] = z + (Math.random() - 0.5) * 3;\r\n        }\r\n        randomValue.push(Math.random() * Math.PI * 3);\r\n      }\r\n\r\n      // randomValue 정의\r\n      planeMesh.geometry.attributes.position.randomValue = randomValue;\r\n\r\n      // OriginalPosition 정의\r\n      planeMesh.geometry.attributes.position.originalPosition =\r\n        planeMesh.geometry.attributes.position.array;\r\n      const colors = [];\r\n      for (let i = 0; i < planeMesh.geometry.attributes.position.count; i++) {\r\n        // r,g,b\r\n        colors.push(0.05, 0.1, 0.2);\r\n      }\r\n\r\n      planeMesh.geometry.setAttribute(\r\n        'color',\r\n        new THREE.BufferAttribute(new Float32Array(colors), 3)\r\n      );\r\n    }\r\n\r\n    // PlaneGeometry\r\n    const planeGeometry = new THREE.PlaneGeometry(\r\n      world.plane.width,\r\n      world.plane.height,\r\n      world.plane.widthSegments,\r\n      world.plane.heightSegments\r\n    );\r\n    const planeMeterial = new THREE.MeshPhongMaterial({\r\n      side: THREE.DoubleSide,\r\n      flatShading: THREE.FlatShading,\r\n      vertexColors: true\r\n    });\r\n    const planeMesh = new THREE.Mesh(planeGeometry, planeMeterial);\r\n    scene.add(planeMesh);\r\n    generatePlane();\r\n\r\n    // 빛\r\n    const light = new THREE.DirectionalLight(0xffffff, 1);\r\n    light.position.set(1, -1, 1);\r\n    scene.add(light);\r\n\r\n    // 뒤쪽 빛\r\n    const backLight = new THREE.DirectionalLight(0xffffff, 1);\r\n    backLight.position.set(0, 0, -1);\r\n    scene.add(backLight);\r\n\r\n    // OrbitControls\r\n    new OrbitControls(camera, renderer.domElement);\r\n\r\n    // 카메라 뷰 깊이\r\n    camera.position.z = 50;\r\n    camera.rotateX(-50);\r\n    camera.rotateY(-50);\r\n    console.log(camera);\r\n\r\n    const mouse = {\r\n      x: undefined,\r\n      y: undefined\r\n    };\r\n\r\n    window.addEventListener('mousemove', (e) => {\r\n      mouse.x = (e.clientX / window.innerWidth) * 2 - 1;\r\n      mouse.y = -(e.clientY / window.innerHeight) * 2 + 1;\r\n    });\r\n\r\n    // frame\r\n    const frame = 0;\r\n\r\n    this.scene = scene;\r\n    this.camera = camera;\r\n    this.renderer = renderer;\r\n    this.planeMesh = planeMesh;\r\n\r\n    this.mouse = mouse;\r\n    this.raycaster = raycaster;\r\n\r\n    this.frame = frame;\r\n    this.randomValue = randomValue;\r\n    this.animate();\r\n\r\n    // 클릭 옵션\r\n    document.querySelector('#link').addEventListener('click', (e) => {\r\n      e.preventDefault();\r\n      gsap.to('#container', {\r\n        opacity: 0\r\n      });\r\n      gsap.to(camera.position, {\r\n        x: 75,\r\n        y: -75,\r\n        z: 1,\r\n        duration: 1.2\r\n      });\r\n      gsap.to(camera.rotation, {\r\n        x: 1,\r\n        y: 1,\r\n        duration: 8\r\n      });\r\n      gsap.to(light, {\r\n        intensity: 0,\r\n        delay: 0.3,\r\n        duration: 1.2\r\n      });\r\n    });\r\n  }\r\n\r\n  // 첫 줄은 카메라 뷰로 렌더링하겠다\r\n  // 다음 두 줄은 3D박스를 x,y축으로 0.01씩 이동하겠다\r\n  // 마지막 requestAnimationFrame 함수는 this.animate함수를 계속 호출하라는 뜻\r\n  // 최대 1ms (1초에 60번씩 그려라) => 성능이 낮은 PC나 CPU/GPU 점유율에 따라 동적으로 변하기도 함\r\n\r\n  animate = () => {\r\n    this.renderer.render(this.scene, this.camera);\r\n    requestAnimationFrame(this.animate);\r\n\r\n    // 배경 움직임\r\n    this.frame += 0.01;\r\n    const {\r\n      array,\r\n      originalPosition,\r\n      randomValue\r\n    } = this.planeMesh.geometry.attributes.position;\r\n\r\n    for (let i = 0; i < array.length; i += 3) {\r\n      // x\r\n      array[i] =\r\n        originalPosition[i] + Math.cos(this.frame + randomValue[i]) * 0.01;\r\n\r\n      this.planeMesh.geometry.attributes.position.needsUpdate = true;\r\n\r\n      // y\r\n      array[i + 1] =\r\n        originalPosition[i + 1] +\r\n        Math.sin(this.frame + randomValue[i + 1]) * 0.01;\r\n\r\n      this.planeMesh.geometry.attributes.position.needsUpdate = true;\r\n    }\r\n\r\n    this.raycaster.setFromCamera(this.mouse, this.camera);\r\n    const intersects = this.raycaster.intersectObject(this.planeMesh);\r\n    if (intersects.length > 0) {\r\n      const { color } = intersects[0].object.geometry.attributes;\r\n\r\n      // vertice 1\r\n      color.setX(intersects[0].face.a, 0.3);\r\n      color.setY(intersects[0].face.a, 0.6);\r\n      color.setZ(intersects[0].face.a, 1);\r\n\r\n      // vertice 2\r\n      color.setX(intersects[0].face.b, 0.3);\r\n      color.setY(intersects[0].face.b, 0.6);\r\n      color.setZ(intersects[0].face.b, 1);\r\n\r\n      // vertice 3\r\n      color.setX(intersects[0].face.c, 0.3);\r\n      color.setY(intersects[0].face.c, 0.6);\r\n      color.setZ(intersects[0].face.c, 1);\r\n\r\n      color.needsUpdate = true;\r\n\r\n      const initialColor = {\r\n        r: 0.05,\r\n        g: 0.1,\r\n        b: 0.2\r\n      };\r\n\r\n      const hoverColor = {\r\n        r: 0.3,\r\n        g: 0.6,\r\n        b: 1\r\n      };\r\n      gsap.to(hoverColor, {\r\n        r: initialColor.r,\r\n        g: initialColor.g,\r\n        b: initialColor.b,\r\n        duration: 1,\r\n        onUpdate: () => {\r\n          // vertice 1\r\n          color.setX(intersects[0].face.a, hoverColor.r);\r\n          color.setY(intersects[0].face.a, hoverColor.g);\r\n          color.setZ(intersects[0].face.a, hoverColor.b);\r\n\r\n          // vertice 2\r\n          color.setX(intersects[0].face.b, hoverColor.r);\r\n          color.setY(intersects[0].face.b, hoverColor.g);\r\n          color.setZ(intersects[0].face.b, hoverColor.b);\r\n\r\n          // vertice 3\r\n          color.setX(intersects[0].face.c, hoverColor.r);\r\n          color.setY(intersects[0].face.c, hoverColor.g);\r\n          color.setZ(intersects[0].face.c, hoverColor.b);\r\n        }\r\n      });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    return <div ref={(el) => (this.element = el)}></div>;\r\n  }\r\n}\r\n\r\nexport default ThreeTuto2;\r\n"]},"metadata":{},"sourceType":"module"}