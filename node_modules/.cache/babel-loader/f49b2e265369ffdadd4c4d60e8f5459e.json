{"ast":null,"code":"'use strict';\n\nvar React = require('react');\n\nvar createComponent = require('./createComponent');\n\nvar LayerMixin = require('./LayerMixin');\n\nvar Layer = require('./Layer');\n\nvar Group = require('./Group');\n\nvar ImageCache = require('./ImageCache');\n\nvar Easing = require('./Easing');\n\nvar clamp = require('./clamp');\n\nvar FADE_DURATION = 200;\nvar RawImage = createComponent('Image', LayerMixin, {\n  applyImageProps: function (prevProps, props) {\n    var layer = this.node;\n    layer.type = 'image';\n    layer.imageUrl = props.src;\n  },\n  mountComponent: function (transaction, nativeParent, nativeContainerInfo, context) {\n    var props = this._currentElement.props;\n    var layer = this.node;\n    this.applyLayerProps({}, props);\n    this.applyImageProps({}, props);\n    return layer;\n  },\n  receiveComponent: function (nextComponent, transaction, context) {\n    var prevProps = this._currentElement.props;\n    var props = nextComponent.props;\n    this.applyLayerProps(prevProps, props);\n    this.applyImageProps(prevProps, props);\n    this._currentElement = nextComponent;\n    this.node.invalidateLayout();\n  }\n});\nvar Image = React.createClass({\n  propTypes: {\n    src: React.PropTypes.string.isRequired,\n    style: React.PropTypes.object,\n    useBackingStore: React.PropTypes.bool,\n    fadeIn: React.PropTypes.bool,\n    fadeInDuration: React.PropTypes.number\n  },\n  getInitialState: function () {\n    var loaded = ImageCache.get(this.props.src).isLoaded();\n    return {\n      loaded: loaded,\n      imageAlpha: loaded ? 1 : 0\n    };\n  },\n  componentDidMount: function () {\n    ImageCache.get(this.props.src).on('load', this.handleImageLoad);\n  },\n  componentWillUpdate: function (nextProps, nextState) {\n    if (nextProps.src !== this.props.src) {\n      ImageCache.get(this.props.src).removeListener('load', this.handleImageLoad);\n      ImageCache.get(nextProps.src).on('load', this.handleImageLoad);\n      var loaded = ImageCache.get(nextProps.src).isLoaded();\n      this.setState({\n        loaded: loaded\n      });\n    }\n  },\n  componentWillUnmount: function () {\n    if (this._pendingAnimationFrame) {\n      cancelAnimationFrame(this._pendingAnimationFrame);\n    }\n\n    ImageCache.get(this.props.src).removeListener('load', this.handleImageLoad);\n  },\n  componentDidUpdate: function (prevProps, prevState) {\n    if (this.refs.image) {\n      this.refs.image.invalidateLayout();\n    }\n  },\n  render: function () {\n    var rawImage;\n    var imageStyle = Object.assign({}, this.props.style);\n    var style = Object.assign({}, this.props.style);\n    var backgroundStyle = Object.assign({}, this.props.style);\n    var useBackingStore = this.state.loaded ? this.props.useBackingStore : false; // Hide the image until loaded.\n\n    imageStyle.alpha = this.state.imageAlpha; // Hide opaque background if image loaded so that images with transparent\n    // do not render on top of solid color.\n\n    style.backgroundColor = imageStyle.backgroundColor = null;\n    backgroundStyle.alpha = clamp(1 - this.state.imageAlpha, 0, 1);\n    return React.createElement(Group, {\n      ref: 'main',\n      style: style\n    }, React.createElement(Layer, {\n      ref: 'background',\n      style: backgroundStyle\n    }), React.createElement(RawImage, {\n      ref: 'image',\n      src: this.props.src,\n      style: imageStyle,\n      useBackingStore: useBackingStore\n    }));\n  },\n  handleImageLoad: function () {\n    var imageAlpha = 1;\n\n    if (this.props.fadeIn) {\n      imageAlpha = 0;\n      this._animationStartTime = Date.now();\n      this._pendingAnimationFrame = requestAnimationFrame(this.stepThroughAnimation);\n    }\n\n    this.setState({\n      loaded: true,\n      imageAlpha: imageAlpha\n    });\n  },\n  stepThroughAnimation: function () {\n    var fadeInDuration = this.props.fadeInDuration || FADE_DURATION;\n    var alpha = Easing.easeInCubic((Date.now() - this._animationStartTime) / fadeInDuration);\n    alpha = clamp(alpha, 0, 1);\n    this.setState({\n      imageAlpha: alpha\n    });\n\n    if (alpha < 1) {\n      this._pendingAnimationFrame = requestAnimationFrame(this.stepThroughAnimation);\n    }\n  }\n});\nmodule.exports = Image;","map":{"version":3,"sources":["C:/Users/sonwonjae/react/react-tutorial/canvas-example/node_modules/react-canvas/lib/Image.js"],"names":["React","require","createComponent","LayerMixin","Layer","Group","ImageCache","Easing","clamp","FADE_DURATION","RawImage","applyImageProps","prevProps","props","layer","node","type","imageUrl","src","mountComponent","transaction","nativeParent","nativeContainerInfo","context","_currentElement","applyLayerProps","receiveComponent","nextComponent","invalidateLayout","Image","createClass","propTypes","PropTypes","string","isRequired","style","object","useBackingStore","bool","fadeIn","fadeInDuration","number","getInitialState","loaded","get","isLoaded","imageAlpha","componentDidMount","on","handleImageLoad","componentWillUpdate","nextProps","nextState","removeListener","setState","componentWillUnmount","_pendingAnimationFrame","cancelAnimationFrame","componentDidUpdate","prevState","refs","image","render","rawImage","imageStyle","Object","assign","backgroundStyle","state","alpha","backgroundColor","createElement","ref","_animationStartTime","Date","now","requestAnimationFrame","stepThroughAnimation","easeInCubic","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nvar React = require('react');\nvar createComponent = require('./createComponent');\nvar LayerMixin = require('./LayerMixin');\nvar Layer = require('./Layer');\nvar Group = require('./Group');\nvar ImageCache = require('./ImageCache');\nvar Easing = require('./Easing');\nvar clamp = require('./clamp');\n\nvar FADE_DURATION = 200;\n\nvar RawImage = createComponent('Image', LayerMixin, {\n\n  applyImageProps: function (prevProps, props) {\n    var layer = this.node;\n\n    layer.type = 'image';\n    layer.imageUrl = props.src;\n  },\n\n  mountComponent: function (\n    transaction,\n    nativeParent,\n    nativeContainerInfo,\n    context\n  ) {\n    var props = this._currentElement.props;\n    var layer = this.node;\n    this.applyLayerProps({}, props);\n    this.applyImageProps({}, props);\n    return layer;\n  },\n\n  receiveComponent: function (nextComponent, transaction, context) {\n    var prevProps = this._currentElement.props;\n    var props = nextComponent.props;\n    this.applyLayerProps(prevProps, props);\n    this.applyImageProps(prevProps, props);\n    this._currentElement = nextComponent;\n    this.node.invalidateLayout();\n  },\n\n});\n\nvar Image = React.createClass({\n\n  propTypes: {\n    src: React.PropTypes.string.isRequired,\n    style: React.PropTypes.object,\n    useBackingStore: React.PropTypes.bool,\n    fadeIn: React.PropTypes.bool,\n    fadeInDuration: React.PropTypes.number\n  },\n\n  getInitialState: function () {\n    var loaded = ImageCache.get(this.props.src).isLoaded();\n    return {\n      loaded: loaded,\n      imageAlpha: loaded ? 1 : 0\n    };\n  },\n\n  componentDidMount: function () {\n    ImageCache.get(this.props.src).on('load', this.handleImageLoad);\n  },\n\n  componentWillUpdate: function(nextProps, nextState) {\n    if(nextProps.src !== this.props.src) {\n      ImageCache.get(this.props.src).removeListener('load', this.handleImageLoad);\n      ImageCache.get(nextProps.src).on('load', this.handleImageLoad);\n      var loaded = ImageCache.get(nextProps.src).isLoaded();\n      this.setState({loaded: loaded});\n    }\n  },\n\n  componentWillUnmount: function () {\n    if (this._pendingAnimationFrame) {\n      cancelAnimationFrame(this._pendingAnimationFrame);\n    }\n    ImageCache.get(this.props.src).removeListener('load', this.handleImageLoad);\n  },\n\n  componentDidUpdate: function (prevProps, prevState) {\n    if (this.refs.image) {\n      this.refs.image.invalidateLayout();\n    }\n  },\n\n  render: function () {\n    var rawImage;\n    var imageStyle = Object.assign({}, this.props.style);\n    var style = Object.assign({}, this.props.style);\n    var backgroundStyle = Object.assign({}, this.props.style);\n    var useBackingStore = this.state.loaded ? this.props.useBackingStore : false;\n\n    // Hide the image until loaded.\n    imageStyle.alpha = this.state.imageAlpha;\n\n    // Hide opaque background if image loaded so that images with transparent\n    // do not render on top of solid color.\n    style.backgroundColor = imageStyle.backgroundColor = null;\n    backgroundStyle.alpha = clamp(1 - this.state.imageAlpha, 0, 1);\n\n    return (\n      React.createElement(Group, {ref: 'main', style: style},\n        React.createElement(Layer, {ref: 'background', style: backgroundStyle}),\n        React.createElement(RawImage, {ref: 'image', src: this.props.src, style: imageStyle, useBackingStore: useBackingStore})\n      )\n    );\n  },\n\n  handleImageLoad: function () {\n    var imageAlpha = 1;\n    if (this.props.fadeIn) {\n      imageAlpha = 0;\n      this._animationStartTime = Date.now();\n      this._pendingAnimationFrame = requestAnimationFrame(this.stepThroughAnimation);\n    }\n    this.setState({ loaded: true, imageAlpha: imageAlpha });\n  },\n\n  stepThroughAnimation: function () {\n    var fadeInDuration = this.props.fadeInDuration || FADE_DURATION;\n    var alpha = Easing.easeInCubic((Date.now() - this._animationStartTime) / fadeInDuration);\n    alpha = clamp(alpha, 0, 1);\n    this.setState({ imageAlpha: alpha });\n    if (alpha < 1) {\n      this._pendingAnimationFrame = requestAnimationFrame(this.stepThroughAnimation);\n    }\n  }\n\n});\n\nmodule.exports = Image;\n"]},"metadata":{},"sourceType":"script"}